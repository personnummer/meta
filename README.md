# meta
Organization meta

## Implementations

| Package | Pkg Version | Spec Version | Status | Maintainer |
|---|---|---|---|---|
| [Bash](https://github.com/personnummer/bash) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/bash?style=flat-square)](https://github.com/personnummer/bash) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/bash/bash.yml?branch=master)](https://github.com/personnummer/bash/actions) | [@bombsimon](https://github.com/bombsimon)
| [C/C++](https://github.com/personnummer/cpp) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/cpp?style=flat-square)](https://github.com/personnummer/cpp) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/cpp/ccpp.yml?branch=master)](https://github.com/personnummer/cpp/actions) | [@bombsimon](https://github.com/bombsimon)
| [C#](https://github.com/personnummer/csharp) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/csharp?style=flat-square)](https://github.com/personnummer/csharp) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![Build status](https://img.shields.io/github/actions/workflow/status/personnummer/csharp/csharp.yml?branch=master)](https://github.com/personnummer/csharp/actions) | [@Johannestegner](https://github.com/johannestegner)
| [D](https://github.com/personnummer/d) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/d?style=flat-square)](https://github.com/personnummer/d) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/d/d.yml?branch=master)](https://github.com/personnummer/d/actions) | [@frozzare](https://github.com/frozzare)
| [Dart](https://github.com/personnummer/dart) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/dart?style=flat-square)](https://github.com/personnummer/dart) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/dart/test.yml?branch=master)](https://github.com/personnummer/dart/actions) | [@frozzare](https://github.com/frozzare)
| [Elixir](https://github.com/personnummer/elixir) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/elixir?style=flat-square)](https://github.com/personnummer/elixir) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/elixir/elixir.yml?branch=master)](https://github.com/personnummer/elixir/actions) | [@bombsimon](https://github.com/bombsimon)
| [Go](https://github.com/personnummer/go) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/go?style=flat-square)](https://github.com/personnummer/go) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/go/go.yml?branch=master)](https://github.com/personnummer/go/actions) | [@frozzare](https://github.com/frozzare)
| [Haskell](https://github.com/personnummer/haskell) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/haskell?style=flat-square)](https://github.com/personnummer/haskell) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/haskell/haskell.yml?branch=main)](https://github.com/personnummer/haskell/actions) | [@bombsimon](https://github.com/bombsimon)
| [Java](https://github.com/personnummer/java) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/java?style=flat-square)](https://github.com/personnummer/java) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow](https://img.shields.io/github/actions/workflow/status/personnummer/haskell/haskell.yml?branch=main)](https://github.com/personnummer/java/actions) | [@Johannestegner](https://github.com/johannestegner)
| [JavaScript](https://github.com/personnummer/js) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/js?style=flat-square)](https://github.com/personnummer/js) | [3.1](https://github.com/personnummer/meta/#package-specification-v31) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/js/nodejs.yml?branch=master)](https://github.com/personnummer/js/actions) | [@frozzare](https://github.com/frozzare)
| [Kotlin](https://github.com/personnummer/kotlin) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/kotlin?style=flat-square)](https://github.com/personnummer/kotlin) | [1.0](https://github.com/personnummer/meta/#package-specification-v1)  | [![GitHub Workflow](https://img.shields.io/github/actions/workflow/status/personnummer/kotlin/test.yml?branch=master)](https://github.com/personnummer/kotlin/actions) | [@Johannestegner](https://github.com/johannestegner)
| [Lua](https://github.com/personnummer/lua) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/lua?style=flat-square)](https://github.com/personnummer/lua) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/lua/lua.yml?branch=master)](https://github.com/personnummer/lua/actions) | [@frozzare](https://github.com/frozzare)
| [PHP](https://github.com/personnummer/php) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/php?style=flat-square)](https://github.com/personnummer/php) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/php/php.yml?branch=master)](https://github.com/personnummer/php/actions) | [@rasmusbe](https://github.com/rasmusbe)
| [Perl](https://github.com/personnummer/perl) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/perl?style=flat-square)](https://github.com/personnummer/perl) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/perl/perl.yml?branch=master)](https://github.com/personnummer/perl/actions) | [@bombsimon](https://github.com/bombsimon)
| [Python](https://github.com/personnummer/python) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/python?style=flat-square)](https://github.com/personnummer/python) | [3.0](https://github.com/personnummer/meta/#package-specification-v3) | [![GitHub Workflow](https://img.shields.io/github/actions/workflow/status/personnummer/python/python.yml?branch=master)](https://github.com/personnummer/python/actions) | [@Buscedv](https://github.com/buscedv)
| [Ruby](https://github.com/personnummer/ruby) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/ruby?style=flat-square)](https://github.com/personnummer/ruby) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow](https://img.shields.io/github/actions/workflow/status/personnummer/ruby/ruby.yml?branch=master)](https://github.com/personnummer/ruby/actions) | [@VoxSecundus](https://github.com/VoxSecundus)
| [Rust](https://github.com/personnummer/rust) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/rust?style=flat-square)](https://github.com/personnummer/rust) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/rust/rust.yml?branch=master)](https://github.com/personnummer/rust/actions) | [@bombsimon](https://github.com/bombsimon)
| [Scala](https://github.com/personnummer/scala) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/scala?style=flat-square)](https://github.com/personnummer/scala) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/scala/scala.yml?branch=master)](https://github.com/personnummer/scala/actions) | [@frozzare](https://github.com/frozzare)
| [Swift](https://github.com/personnummer/swift) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/swift?style=flat-square)](https://github.com/personnummer/swift) | [1.0](https://github.com/personnummer/meta/#package-specification-v1)  | [![GitHub Workflow](https://img.shields.io/github/actions/workflow/status/personnummer/swift/swift.yml?branch=master)](https://github.com/personnummer/swift/actions) | [@GoranLilja](https://github.com/GoranLilja)
| [V](https://github.com/personnummer/v) | [![GitHub release (latest by date)](https://img.shields.io/github/v/release/personnummer/v?style=flat-square)](https://github.com/personnummer/v) | [3.0](https://github.com/personnummer/meta/#package-specification-v3)  | [![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/personnummer/v/v.yml?branch=main)](https://github.com/personnummer/v/actions) | [@frozzare](https://github.com/frozzare)
## License Specification

We use the [MIT license](https://opensource.org/licenses/MIT) for all packages and the copyright row should look like this:

```
Copyright (c) Personnummer and Contributors
```

## Package Specification (v1)

The personnummer package should have a `valid` method that can take both a number and a string as input.

```js
personnummer.valid(string)
personnummer.valid(number)
```

## Package Specification (v2)

The personnummer package should have a `valid` method that can take both a number and a string as input.

The second argument should be a optional boolean that exclude coordination number (Samordningsnummer) from validation.

```js
personnummer.valid(string, [bool includeCoordinationNumber = true])
personnummer.valid(number, [bool includeCoordinationNumber = true])
```

The package should include a `format` method that can format the input value (string or number) as a short or long personnumer.

The second argument should be a optional boolean and `true` should format the input value as a long personnummer.

```js
personnummer.format(number, [bool longFormat = false])
personnummer.format(string, [bool longFormat = false])
```

The package should include a `getAge` method that returns the age from a personnummer. For coordination number (Samordningsnummer) we should remove `60` to get the right age.

The second argument should be a optional boolean that exclude coordination number (Samordningsnummer) from validation.

```js
personnummer.getAge(number, [bool includeCoordinationNumber = true])
personnummer.getAge(string, [bool includeCoordinationNumber = true])
```

### Input value format

Dash or plus should be optional.

```
YYMMDD-XXXX
YYMMDD+XXXX
YYMMDDXXXX

YYYYMMDD-XXXX
YYYYMMDD+XXXX
YYYYMMDDXXXX
```

Coordination number (Samordningsnummer) should also be a valid personnummer.

### Short format

Output for `format` method

```
YYMMDD-XXXX
```

### Long format

Output for `format` method

```
YYYYMMDDXXXX
```

## Package Specification (v2.1)

This specification adds new features and includes all parts from 2.0.

The package should include `isMale` and `isFemale` methods that can check if the personnummer or coordination number is a female or male.

```js
personnummer.isMale(number|string, [bool includeCoordinationNumber = true])
personnummer.isFemale(number|string, [bool includeCoordinationNumber = true])
```

This methods should throw errors when input value is not a valid personnummer or coordination number.

## Package Specification (v3)

Version 3 will contain breaking changes and will not be compatible with version 1 or 2.

### Breaking changes

These functions will be moved into the class:

* `format`
* `getAge`
* `isFemale`
* `isMale`

### Valid

The `valid` function can be a function or a static method on the class depending on language. The valid version that supports number arguments will be removed.

### Class

The package should include a class that which should be the return value of `parse`

```js
class Personnummer {
    public function __construct(string, array|object|languageSpecific)
}
```

### Parse

The package should include a `parse` method that creates a new instance of the new class.

The `parse` and the class constructor should contain a second argument with options for the feature.

```js
personnummer.parse(string, array|object|languageSpecific = []) => new class instance
```

The class should contain a static `parse` method that returns the class instance.

```js
const pnr = Personnummer::parse(string, array|object|languageSpecific = [])
```

### Coordination numbers

The coordination number option will be removed for all methods and be replaced with `isCoordinationNumber` method or property instead.

```js
const pnr = personnummer.parse(string)

if (pnr.isCoordinationNumber()) {
    return
}
```

### Error handling

All methods except for `valid` should throw an exception or return an error as a second return value. Error handling may be different depending on language. The exception/error class should be prefixed with `Personnummer`

### Options

Options may be different depending on language.

### Pseudo-interface

```js
interface Personnummer {
    string century;
    string fullYear;
    string year;
    string month;
    string day;
    string sep;
    string num;
    string check;

    public function __construct(string ssn, array|object|languageSpecific options = []);

    public static function parse(string ssn);

    public function format(boolean longFormat) : string;
    public function getAge() : int;
    public function isFemale() : boolean;
    public function isMale() : boolean;
    public function isCoordinationNumber() : boolean;
}

function valid(string ssn) {
    try {
       parse(ssn)
       return true
    } catch (PersonnummerParseException) {
        return false
    }
}

function parse(string ssn, array|object|languageSpecific options = []) {
    return new Personnummer(ssn, options)
}
```

## Package Specification (v3.1)

This specification adds new features and includes all parts from 3.0.

## Get date

The package should include `getDate` function to expose the underlying date value. For coordination numbers the day should be removed with 60 days to get the correct day for a real date.

## Interim-Number

_Also called T-Number_

The package should support Interim-numbers `YYMMDD-Xnnn` (where X is a letter rather than number) and include `isInterimNumber` function in the same way as `isCoordinationNumber`

The `format` function should respect Interim-number and format the number both in the long and short way with the letter at the first of the four in the 4-digit number.

Read more about interim-number at [KTH](https://www.kth.se/en/student/studier/living-in-sweden/swedish-personal-identification-number/swedish-personal-identification-number-1.443883) and at [sunet](https://wiki.sunet.se/display/SWAMID/Svenska+personnummer%3A+norEduPersonNIN%2C+personalIdentityNumber+och+schacDateOfBirth).

To make the package future-proof, we support all 11 interim letters: `T, R, S, U, W, X, J, K, L, M, N` where all are replaced with a `1` in the luhn calculation.

To not break the package for users whom do not want to make use of the interim-number implementation, the `options` object for the parse function and constructor have been re-added and should have two values:

```json
{
  "allowCoordinationNumber": true,
  "allowInterimNumber": false
}
```

As seen, the coordination-number should be true by default (as it's true by default in the v3.0 api) while the interim-number is false by default (as it does not exist yet and is used a lot more rarely).


### Updated pseudo-interface

```js
interface Personnummer {
    public function getDate() : Date;
    public function isInterimNumber() : boolean;
}
```
